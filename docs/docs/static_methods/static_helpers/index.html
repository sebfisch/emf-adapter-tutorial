<!DOCTYPE html>
<html lang="en" dir=>

<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Static methods with additional functionality There many opions for how to implement additional functionality for the types in our game-state model. We could
 modify the source code generated by EMF, use inheritance to extend the generated interfaces, define static methods operating on model types, or use delegation to operate on wrapped model instances.  This tutorial is about learning to do option 4 with EMF adapters. However, the first version of the Tic-Tac-Toe app does not yet use adapters.">
<meta name="theme-color" content="#FFFFFF"><meta property="og:title" content="Static Helpers" />
<meta property="og:description" content="Static methods with additional functionality There many opions for how to implement additional functionality for the types in our game-state model. We could
 modify the source code generated by EMF, use inheritance to extend the generated interfaces, define static methods operating on model types, or use delegation to operate on wrapped model instances.  This tutorial is about learning to do option 4 with EMF adapters. However, the first version of the Tic-Tac-Toe app does not yet use adapters." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://sebfisch.github.io/emf-adapter-tutorial/docs/static_methods/static_helpers/" />
<meta property="article:modified_time" content="2020-06-17T12:33:17+02:00" />
<title>Static Helpers | EMF Adapter Tutorial</title>
<link rel="manifest" href="/emf-adapter-tutorial/manifest.json">
<link rel="icon" href="/emf-adapter-tutorial/favicon.png" type="image/x-icon">
<link rel="stylesheet" href="/emf-adapter-tutorial/book.min.e161f1fe2b283b6a43c29a52fde96e2387fade573e78efa6701d44c8499da76b.css" integrity="sha256-4WHx/isoO2pDwppS/eluI4f63lc&#43;eO&#43;mcB1EyEmdp2s="><!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->

  
</head>

<body dir=>
  <input type="checkbox" class="hidden" id="menu-control" />
  <main class="container flex">
    <aside class="book-menu">
      
  <nav>
<h2 class="book-brand">
  <a href="/emf-adapter-tutorial"><span>EMF Adapter Tutorial</span>
  </a>
</h2>












  



  
  
  
  

  
  <ul>
    
      
        <li>
          
  
    <a href="/emf-adapter-tutorial/docs/static_methods/" class="">Tic-Tac-Toe App</a>
  

          
  
  
  

  
  <ul>
    
      
        <li>
          
  
    <a href="/emf-adapter-tutorial/docs/static_methods/game_state_model/" class="">Game-State Model</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/emf-adapter-tutorial/docs/static_methods/static_constructors/" class="">Static Constructors</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/emf-adapter-tutorial/docs/static_methods/static_helpers/" class="active">Static Helpers</a>
  

        </li>
      
    
  </ul>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/emf-adapter-tutorial/docs/plain_adapters/" class="">Plain Adapters</a>
  

          
  
  
  

  
  <ul>
    
      
        <li>
          
  
    <a href="/emf-adapter-tutorial/docs/plain_adapters/model_access/" class="">Model Access</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/emf-adapter-tutorial/docs/plain_adapters/user_interface/" class="">User Interface</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/emf-adapter-tutorial/docs/plain_adapters/adapter_factories/" class="">Adapter Factories</a>
  

        </li>
      
    
  </ul>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/emf-adapter-tutorial/docs/object_adapter/" class="">Object Adapter</a>
  

          
  
  
  

  
  <ul>
    
  </ul>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/emf-adapter-tutorial/docs/programming_tasks/" class="">Programming Tasks</a>
  

          
  
  
  

  
  <ul>
    
      
        <li>
          
  
    <a href="/emf-adapter-tutorial/docs/programming_tasks/typed_adapters/" class="">Typed Adapters</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/emf-adapter-tutorial/docs/programming_tasks/winning_check/" class="">Winning Check</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/emf-adapter-tutorial/docs/programming_tasks/escape_restart/" class="">Escape Restart</a>
  

        </li>
      
    
  </ul>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/emf-adapter-tutorial/docs/background/" class="">Background</a>
  

          
  
  
  

  
  <ul>
    
      
        <li>
          
  
    <a href="/emf-adapter-tutorial/docs/background/functional_interfaces/" class="">Functional Interfaces</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/emf-adapter-tutorial/docs/background/type_parameters/" class="">Type Parameters</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/emf-adapter-tutorial/docs/background/stream_programming/" class="">Stream Programming</a>
  

        </li>
      
    
  </ul>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/emf-adapter-tutorial/docs/resources/" class="">Resources</a>
  

          
  
  
  

  
  <ul>
    
  </ul>
  

        </li>
      
    
  </ul>
  















</nav>




  <script>(function(){var menu=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(event){localStorage.setItem("menu.scrollTop",menu.scrollTop);});menu.scrollTop=localStorage.getItem("menu.scrollTop");})();</script>


 
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/emf-adapter-tutorial/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <strong>Static Helpers</strong>

  <label for="toc-control">
    <img src="/emf-adapter-tutorial/svg/toc.svg" class="book-icon" alt="Table of Contents" />
  </label>
</div>


  
    <input type="checkbox" class="hidden" id="toc-control" />
    <aside class="hidden clearfix">
      
  <nav id="TableOfContents">
  <ul>
    <li><a href="#board-helpers">Board helpers</a></li>
    <li><a href="#field-helpers">Field helpers</a></li>
    <li><a href="#code-review">Code Review</a></li>
  </ul>
</nav>


    </aside>
  
 
      </header>

      
      
  <article class="markdown"><h1 id="static-methods-with-additional-functionality">Static methods with additional functionality</h1>
<p>There many opions for how to implement additional functionality for the types in our game-state model.
We could</p>
<ol>
<li>modify the source code generated by EMF,</li>
<li>use inheritance to extend the generated interfaces,</li>
<li>define static methods operating on model types, or</li>
<li>use delegation to operate on wrapped model instances.</li>
</ol>
<p>This tutorial is about learning to do option 4 with EMF adapters. However, the first version of the Tic-Tac-Toe app does not yet use adapters.
It uses option 3, defining static helpers, that will be contrasted with adapters in the next part of the tutorial.</p>
<p>The <a href="https://github.com/sebfisch/emf-adapter-tutorial-code/tree/step1-static-methods-v1/de.sebfisch.tictactoe/src/game/helpers">game.helpers package</a> contains classes with static methods for <code>Board</code> and <code>Field</code> instances.</p>
<h2 id="board-helpers">Board helpers</h2>
<p>We already saw the method <code>BoardHelpers.getComponent</code> which creates a user-interface component representing a <code>Board</code> instance with a 3x3 grid of field components.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#75715e">// game.helpers.BoardHelpers
</span><span style="color:#75715e"></span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> JComponent <span style="color:#a6e22e">getComponent</span><span style="color:#f92672">(</span><span style="color:#66d9ef">final</span> Board board<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
	<span style="color:#66d9ef">final</span> JPanel panel <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> JPanel<span style="color:#f92672">();</span>
	panel<span style="color:#f92672">.</span><span style="color:#a6e22e">setLayout</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> GridLayout<span style="color:#f92672">(</span>GRID_SIZE<span style="color:#f92672">,</span> GRID_SIZE<span style="color:#f92672">));</span>
	board<span style="color:#f92672">.</span><span style="color:#a6e22e">getFields</span><span style="color:#f92672">().</span><span style="color:#a6e22e">forEach</span><span style="color:#f92672">(</span>field <span style="color:#f92672">-&gt;</span> <span style="color:#f92672">{</span>
		FieldHelpers<span style="color:#f92672">.</span><span style="color:#a6e22e">addUnmarkedFieldComponent</span><span style="color:#f92672">(</span>field<span style="color:#f92672">,</span> panel<span style="color:#f92672">);</span>
	<span style="color:#f92672">});</span>
	<span style="color:#66d9ef">return</span> panel<span style="color:#f92672">;</span>
<span style="color:#f92672">}</span>
</code></pre></div><p>The call to <code>forEach</code> is another example for a lambda expression. This one is converted into an instance of the <code>Consumer</code> interface.
You can learn more about <a href="../../background/functional_interfaces#consumers">consumers</a> in a background section.</p>
<p>Another method (that we will see being used later when marking fields) replaces one of the unmarked field components with a different component.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#75715e">// game.helpers.BoardHelpers
</span><span style="color:#75715e"></span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span>
<span style="color:#a6e22e">replaceChild</span><span style="color:#f92672">(</span><span style="color:#66d9ef">final</span> JComponent parent<span style="color:#f92672">,</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span> index<span style="color:#f92672">,</span> <span style="color:#66d9ef">final</span> JComponent child<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
	parent<span style="color:#f92672">.</span><span style="color:#a6e22e">remove</span><span style="color:#f92672">(</span>index<span style="color:#f92672">);</span>
	parent<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>child<span style="color:#f92672">,</span> index<span style="color:#f92672">);</span>
	parent<span style="color:#f92672">.</span><span style="color:#a6e22e">revalidate</span><span style="color:#f92672">();</span>
	parent<span style="color:#f92672">.</span><span style="color:#a6e22e">repaint</span><span style="color:#f92672">();</span>
<span style="color:#f92672">}</span>
</code></pre></div><h2 id="field-helpers">Field helpers</h2>
<p>The user-interface components for unmarked <code>Field</code> instances are created in a static method of the class <code>FieldHelpers</code>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#75715e">// game.helpers.FieldHelpers
</span><span style="color:#75715e"></span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span>
<span style="color:#a6e22e">addUnmarkedFieldComponent</span><span style="color:#f92672">(</span><span style="color:#66d9ef">final</span> Field field<span style="color:#f92672">,</span> <span style="color:#66d9ef">final</span> JComponent parent<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
	<span style="color:#66d9ef">final</span> JButton button <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> JButton<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">);</span>
	button<span style="color:#f92672">.</span><span style="color:#a6e22e">setPreferredSize</span><span style="color:#f92672">(</span>FIELD_DIMENSIONS<span style="color:#f92672">);</span>
	button<span style="color:#f92672">.</span><span style="color:#a6e22e">addActionListener</span><span style="color:#f92672">(</span>_event <span style="color:#f92672">-&gt;</span> <span style="color:#f92672">{</span>
		makeMoveAt<span style="color:#f92672">(</span>field<span style="color:#f92672">);</span>
		updateMark<span style="color:#f92672">(</span>field<span style="color:#f92672">,</span> parent<span style="color:#f92672">);</span>
	<span style="color:#f92672">});</span>
	parent<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>button<span style="color:#f92672">);</span>
<span style="color:#f92672">}</span>
</code></pre></div><p>This method creates an empty button representing an unmarked field.
Apart from a <code>Field</code> instance, this method takes the parent component as second argument.
The button is added to the parent component in the end, but the parent component is also passed to the <code>updateMark</code> method in an action listener for the created button.</p>
<p>When pressing the button, the game-state is modified by the call <code>makeMoveAt(field)</code> which places a mark of the current player on the given <code>field</code> and switches the current player.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#75715e">// game.helpers.FieldHelpers
</span><span style="color:#75715e"></span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">makeMoveAt</span><span style="color:#f92672">(</span><span style="color:#66d9ef">final</span> Field field<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
	<span style="color:#66d9ef">final</span> Board board <span style="color:#f92672">=</span> field<span style="color:#f92672">.</span><span style="color:#a6e22e">getBoard</span><span style="color:#f92672">();</span>
	<span style="color:#66d9ef">final</span> Player player <span style="color:#f92672">=</span> board<span style="color:#f92672">.</span><span style="color:#a6e22e">getCurrentPlayer</span><span style="color:#f92672">();</span>
	field<span style="color:#f92672">.</span><span style="color:#a6e22e">setMark</span><span style="color:#f92672">(</span>GameConstructors<span style="color:#f92672">.</span><span style="color:#a6e22e">markFor</span><span style="color:#f92672">(</span>player<span style="color:#f92672">));</span>
	board<span style="color:#f92672">.</span><span style="color:#a6e22e">setCurrentPlayer</span><span style="color:#f92672">(</span>Player<span style="color:#f92672">.</span><span style="color:#a6e22e">X</span><span style="color:#f92672">.</span><span style="color:#a6e22e">equals</span><span style="color:#f92672">(</span>player<span style="color:#f92672">)</span> <span style="color:#f92672">?</span> Player<span style="color:#f92672">.</span><span style="color:#a6e22e">O</span> <span style="color:#f92672">:</span> Player<span style="color:#f92672">.</span><span style="color:#a6e22e">X</span><span style="color:#f92672">);</span>
<span style="color:#f92672">}</span>
</code></pre></div><p>The method <code>markFor</code> in the <a href="https://github.com/sebfisch/emf-adapter-tutorial-code/blob/step1-static-methods-v1/de.sebfisch.tictactoe/src/constructors/GameConstructors.java">game constructors</a> class creates an instance of <code>Mark</code> with the given <code>player</code>.
After the game state is modified, the method <code>updateMark</code> queries it and adjusts the user interface accordingly.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#75715e">// game.helpers.FieldHelpers
</span><span style="color:#75715e"></span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">updateMark</span><span style="color:#f92672">(</span><span style="color:#66d9ef">final</span> Field field<span style="color:#f92672">,</span> <span style="color:#66d9ef">final</span> JComponent parent<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
	getMarkingPlayer<span style="color:#f92672">(</span>field<span style="color:#f92672">).</span><span style="color:#a6e22e">ifPresent</span><span style="color:#f92672">(</span>player <span style="color:#f92672">-&gt;</span> <span style="color:#f92672">{</span>
		<span style="color:#66d9ef">final</span> JComponent child <span style="color:#f92672">=</span>
			UiConstructors<span style="color:#f92672">.</span><span style="color:#a6e22e">boldLabel</span><span style="color:#f92672">(</span>player<span style="color:#f92672">.</span><span style="color:#a6e22e">toString</span><span style="color:#f92672">(),</span> LABEL_SIZE<span style="color:#f92672">);</span>
		BoardHelpers<span style="color:#f92672">.</span><span style="color:#a6e22e">replaceChild</span><span style="color:#f92672">(</span>parent<span style="color:#f92672">,</span> field<span style="color:#f92672">.</span><span style="color:#a6e22e">getIndex</span><span style="color:#f92672">(),</span> child<span style="color:#f92672">);</span>
	<span style="color:#f92672">});</span>
<span style="color:#f92672">}</span>
</code></pre></div><p>This method replaces the button for the given <code>field</code> in the <code>parent</code> component with a label created by <code>boldLabel</code> in the <a href="https://github.com/sebfisch/emf-adapter-tutorial-code/blob/step1-static-methods-v1/de.sebfisch.tictactoe/src/constructors/UiConstructors.java">user interface constructors</a> class.
The method <code>getMarkingPlayer</code> queries the <code>Player</code> that marked the given field, if there is a mark.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#75715e">// game.helpers.FieldHelpers
</span><span style="color:#75715e"></span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> Optional<span style="color:#f92672">&lt;</span>Player<span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">getMarkingPlayer</span><span style="color:#f92672">(</span><span style="color:#66d9ef">final</span> Field field<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
	<span style="color:#66d9ef">return</span> Optional<span style="color:#f92672">.</span><span style="color:#a6e22e">ofNullable</span><span style="color:#f92672">(</span>field<span style="color:#f92672">.</span><span style="color:#a6e22e">getMark</span><span style="color:#f92672">()).</span><span style="color:#a6e22e">map</span><span style="color:#f92672">(</span>Mark<span style="color:#f92672">::</span>getPlayer<span style="color:#f92672">);</span>
<span style="color:#f92672">}</span>
</code></pre></div><p>As not every <code>Field</code> is necessarily marked by a player, the result of this method is of the <code>Optional</code> type.
<code>Optional</code> is an example of a type with a <a href="../../background/type_parameters#optional-values">type parameter</a>.
Its <code>map</code> method takes an instance of the <code>Function</code> interface which we instantiate here using a so called <a href="../../background/functional_interfaces#method-references">method reference</a>.
Follow the links to read more about the parameterized <code>Optional</code> type or method references in the background section.</p>
<h2 id="code-review">Code Review</h2>
<p>The presented helper methods can be grouped into different categories.
The board helpers are all related to the user interface component representing a board.
From the field helpers, two are concerned with the user interface and two are concerned with querying or modifying the game state.
Methods in one group may call methods in other groups.
For example, <code>updateMark</code> is a field helper concerned with the user interface which calls a field helper concerned with the game state and a board helper concerned with the user interface.</p>
<p>It would be beneficial to restructure the implemented functionality to have a more clear separation between accessing the game state and managing the user interface.
This restructuring should be done in a way that still supports cross references where necessary.</p>
<p>In order to replace the user interface for an unmarked field with a mark, the user interface component representing the board is passed as argument to several helper methods.
From the corresponding method signatures it is not immediately clear that the <code>parent</code> component is always the board representation.
In fact, the methods could be called with different <code>parent</code> components as arguments with possibly inintended results.</p>
<p>It would be beneficial to associate the user interface component representing the board with the board it represents to avoid such confusion.</p>
<p>The update of the user interface of fields is triggered directly by the button representing unmarked fields.
As a consequence, alternative updates of the game state (for example, when implementing a computer opponent) would not be reflected in the user interface automatically.</p>
<p>It would be beneficial to trigger the user interface update as a reaction to arbitrary game-state modifications of marks in fields to decouple the user interface update from specific actions that cause marks to change.</p>
<p>In the <a href="../../plain_adapters">next part</a> of this tutorial we will refactor the Tic-Tac-Toe app to implement the suggested improvements using EMF adapters.</p>
</article>
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">





</div>

 
        &copy; 2020, Sebastian Fischer,
<a rel="license" href="http://creativecommons.org/licenses/by-nd/4.0/"
  >CC-BY-ND 4.0</a
>

      </footer>

      
  
 

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
    <aside class="book-toc">
      
  <nav id="TableOfContents">
  <ul>
    <li><a href="#board-helpers">Board helpers</a></li>
    <li><a href="#field-helpers">Field helpers</a></li>
    <li><a href="#code-review">Code Review</a></li>
  </ul>
</nav>

 
    </aside>
    
  </main>

  
</body>

</html>












